---
title: 概率
---
# 1. 基本概率论
从概率分布中抽取样本的过程称为抽样（sampling）
将概率分配给一些离散选择的分布称为多项分布（multinomial distribution）。
```
from torch.distributions import multinomial # 多项分布
fair_probs = torch.ones([6]) / 6
multinomial.Multinomial(1, fair_probs).sample()
# 进行采样，返回每种情况出现的采样次数
# 进行500组实验，每组抽取10个样本。
counts = multinomial.Multinomial(10, fair_probs).sample((500,)) 
```
## 1.1. 概率论公理
概率（probability）可以被认为是将集合映射到真实值的函数。在给定的样本空间$\mathcal{S}$中，事件$\mathcal{A}$的概率，表示为$P(\mathcal{A})$，满足以下属性：
- 对于任意事件$\mathcal{A}$，其概率从不会是负数，即$P(\mathcal{A})\ge0$；
- 整个样本空间的概率为1，即$P(\mathcal{S})=1$；
- 对于互斥（mutually exclusive）事件（对于所有$i\neq$j都有$\mathcal{A}_i\cap\mathcal{A}_j=\cancel{0}$）的任意一个可数序列$\mathcal{A}_1,\mathcal{A}_2,...$，序列中任意一个事件发生的概率等于它们各自发生的概率之和，即$P(\cup^{\infty}_{i=1}\mathcal{A}_i)=\sum^{\infty}_{i=1}P(\mathcal{A}_i)$。


## 1.2. 随机变量
离散（discrete）随机变量（如骰子的每一面） 和连续（continuous）随机变量（如人的体重和身高）之间存在微妙的区别。 

# 2. 处理多个随机变量
## 2.1. 联合概率  联合分布
给定任意值a和b，联合概率可以回答：$A=a$和$B=b$同时满足的概率是多少？  $P(A=a,B=b)$
对于任何a和b的取值，$P(A=a,B=b)\leq P(A=a)$
## 2.2. 条件概率  条件分布
联合概率的不等式带给我们一个比率：
$$0\leq \frac{P(A=a,B=b)}{P(A=a)}\leq 1$$
这个比率为条件概率（conditional probability），表示：$P(B=b|A=a)$ ：B=b的概率，前提是A=a已发生。
## 2.3. 贝叶斯定理
根据条件概率的乘法法则：$P(A,B)=P(B|A)P(A)$，及对称性$P(A,B)=P(A|B)P(B)$,假设$P(B)>0$,求解其中一个条件变量：
$$P(A|B)=\frac{P(B|A)P(A)}{P(B)}$$
## 2.4. 边际化  边际概率  边际分布
即B的概率相当于计算A的所有可能选择，并将所有选择的联合概率聚合在一起：
$$P(B)=\sum_{A}P(A,B)$$
## 2.5. 独立性
另一个有用属性是依赖（dependence）与独立（independence）。
 如果两个随机变量A和B是独立的，意味着事件A的发生跟B事件的发生无关。表述为$A\perp B$ 
在所有其他情况下，我们称A和B依赖。 

> 两个随机变量是独立的，当且仅当两个随机变量的联合分布是其各自分布的乘积。

同样地，给定另一个随机变量C时，两个随机变量A和B是条件独立的（conditionally independent）， 当且仅当$P(A,B|C)=P(A|C)P(B|C)$。 这个情况表示为$A\perp B\mid C$ 。








---
> 假设有一系列随机变量，其中B只依赖于A，C只依赖于B，怎样描述A,B,C的联合概率

P(A,B,C)=P(A)⋅P(B∣A)⋅P(C∣B)

> P(A) 是A的边缘概率，即A发生的概率，不依赖于其他任何变量。

什么叫做依赖？
“依赖”通常指的是两个或多个随机变量之间的关系，其中一个随机变量的取值或分布会影响另一个随机变量的取值或分布。当两个随机变量之间存在依赖关系时，我们不能简单地将它们的概率视为独立的，即一个变量的发生概率不受另一个变量发生概率的影响。

直观上可以使用**维恩图**来表示集合之间可能存在的逻辑关系。
```
表示独立关系：
如果两个随机变量X和Y是相互独立的，那么它们的维恩图将显示两个完全不重叠的圆圈，或者虽然重叠但重叠部分的面积（即联合概率）等于两个圆圈各自面积（即边缘概率）的乘积。
独立的定义：
A的发生不会影响B的发生（反过来也一样），则AB为相互独立事件。要满足P(AB)=P(A)P(B)
依赖关系分为：完全依赖，部分依赖，条件依赖。
```


在问题“假设有一系列随机变量，其中B只依赖于A，C只依赖于B”中，如果C不和A重叠，那A,B,C的联合概率必是0吗？
首先，C不和A重叠，这里的“重叠”在概率论的语境下，通常指的是两个事件是否有共同发生的可能性，即它们的交集是否为空集。
然而，在讨论A、B、C的联合概率P(A,B,C)时，我们关注的是这三个事件同时发生的概率。这个联合概率并不直接取决于单个事件之间是否有“重叠”（在非空集意义上），而是取决于它们根据依赖关系构成的联合事件空间。
1、如果C不和A在事件空间上有直接交集：
这意味着从直观上看，A和C描述的是两种互斥的情况（在极端情况下）。但这并不直接决定P(A,B,C)的值为0，因为C是依赖于B的，而B又依赖于A。
重要的是要理解，即使A和C在直观上没有交集，它们仍然可以通过B这个中介变量产生联系。例如，A可以发生某个值，使得B也发生一个特定的值，而这个B的值又导致C发生。在这种情况下，P(A,B,C)可以是非零的。
2、何时P(A,B,C)=0：
- P(A)=0（即事件A是一个不可能事件）。
- P(B∣A)=0（即在A发生的条件下，B是一个不可能事件）。
- P(C∣B)=0（即在B发生的条件下，C是一个不可能事件）

